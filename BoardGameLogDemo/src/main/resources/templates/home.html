<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>遊戲統計首頁</title>
<!-- Bootstrap CSS -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
<!-- Google Charts API -->
<script type="text/javascript"
	src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
    google.charts.load('current', {
        'packages': ['bar']
    });
    google.charts.setOnLoadCallback(drawChart);
    
    function drawChart() {
        // 使用 fetch 取得資料
        fetch('./gameStats')
            .then(response => response.json())
            .then(data => {
                // 將資料轉換為 Google Charts 需要的格式
                const chartData = Object.entries(data).map(([gameName, playTimes]) => [gameName, playTimes]);

                // 建立資料表
                const dataTable = new google.visualization.DataTable();
                dataTable.addColumn('string', 'gameName');
                dataTable.addColumn('number', 'playTimes');
                dataTable.addRows(chartData);

                // 設定圖表選項
                const options = {
                    title: 'Chart Title',
                    // 其他選項設定...
                };

                // 建立圖表並繪製
                const chart = new google.visualization.PieChart(document.getElementById('chart_div'));
                chart.draw(dataTable, options);
            })
            .catch(error => console.error('Error fetching data:', error));
    }
    <!--
    function drawChart() {
        fetch('./gameStats')
            .then(response => response.json())
            .then(data => {
                console.log(data); // 確保你能夠看到資料在控制台的輸出
                drawBarChart(data); // 調用繪製橫向長條圖的函式
            })
    }

    function drawBarChart(data) {
        // 橫向長條圖表
        var barData = google.visualization.arrayToDataTable([
            ['遊戲', '遊玩次數'],data
            // 在這裡添加更多遊戲和遊玩次數的資料
        ]);

        data.forEach(entry => {
            barData.addRow([entry.gameName, entry.playTimes]);
        });

		var barOptions = {
			chart : {
				title : '不同遊戲遊玩次數',
				subtitle : '每款遊戲的遊玩次數統計'
			},
			bars : 'horizontal' // 將條形圖設置為橫向
		};

		var barChart = new google.charts.Bar(document
				.getElementById('bar_chart'));
		barChart.draw(barData, google.charts.Bar.convertOptions(barOptions));
		-->
    /*]]>*/
        
<!--		 // 月曆圖表
		var calendarData = new google.visualization.DataTable();
		calendarData.addColumn({
			type : 'date',
			id : 'Date'
		});
		calendarData.addColumn({
			type : 'number',
			id : '遊戲次數'
		});
		calendarData.addRows([ [ new Date(2024, 0, 1), 5 ],
				[ new Date(2024, 0, 15), 10 ], [ new Date(2024, 1, 1), 4 ],
				[ new Date(2023, 10, 6), 6 ], [ new Date(2024, 11, 25), 8 ],
		// 在這裡添加更多日期和遊戲次數的資料
		]);

		var calendarOptions = {
			title : "遊戲日期統計",
			height : 350,
		};
		var calendarChart = new google.visualization.Calendar(document
				.getElementById('calendar_chart'));
		calendarChart.draw(calendarData, calendarOptions);
	}
-->
</script>
</head>
<body>
	<div th:insert="header :: header"></div>

	<div>
		<div class="col-md-6  m-5">
			<!-- 橫向長條圖表容器 -->
			<div id="bar_chart" style="height: 300px;"></div>
		</div>
		<div class="col-md-6 m-5">
			<!-- 月曆圖表容器 -->
			<div id="calendar_chart"></div>
		</div>
	</div>


	<!-- Bootstrap JS 和 Popper.js -->
	<script
		src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js"></script>
</body>
</html>